"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path = require("path");
const fs_1 = require("fs");
const utils_1 = require("../utils");
const common_1 = require("./common");
async function postUnInstall() {
    const gitFolderPath = await common_1.getGitFolderPath();
    if (gitFolderPath === null) {
        return;
    }
    for (const hook of common_1.hooks) {
        const customHookName = `${hook}.git-flow`;
        const hookPath = path.resolve(gitFolderPath, 'hooks', hook);
        const customHookPath = path.resolve(gitFolderPath, 'hooks', customHookName);
        try {
            await utils_1.fsAsync.access(customHookPath);
            utils_1.logger.info(`remove ${customHookName}`);
            await utils_1.fsAsync.unlink(customHookPath);
        }
        catch (err) {
        }
        try {
            await utils_1.fsAsync.access(hookPath, fs_1.constants.W_OK);
            const content = (await utils_1.fsAsync.readFile(hookPath)).toString('utf8');
            await utils_1.fsAsync.writeFile(hookPath, content.replace(common_1.writeIntoHookRegExp, ''), { mode: '755' });
        }
        catch (err) {
        }
    }
}
postUnInstall();
